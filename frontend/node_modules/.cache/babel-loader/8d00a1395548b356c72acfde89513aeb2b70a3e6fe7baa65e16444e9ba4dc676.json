{"ast":null,"code":"import _regeneratorRuntime from\"/Users/admin/Desktop/projects/wetop/taxi/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/admin/Desktop/projects/wetop/taxi/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/admin/Desktop/projects/wetop/taxi/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import styles from'./Login.module.scss';import{setToken}from'../../services/localStorageService';import{routes}from'../../helpers/routes';import{useNavigate}from'react-router-dom';import Header from'../../components/Header/Header';import{loginQuery}from'../../services/authService';import{getUserInfoByToken}from'../../services/userService';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Login(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),inputPhone=_useState2[0],setInputPhone=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),inputPassword=_useState4[0],setInputPassword=_useState4[1];var navigate=useNavigate();// const onSuccessLogin = (res) => {\n//   const token = res?.data?.auth_token;\n//   setToken(token);\n//   getUserInfoByToken()\n//     .then(({ data }) => {\n//       const userType = data.user_type;\n//       if (userType === 'dispatcher') navigate(routes.dispatcher);\n//       if (userType === 'bartender') navigate(routes.barmen);\n//       if (userType === 'driver') navigate(routes.driver);\n//     })\n//     .catch((err) => {\n//       alert('Ошибка получения данных');\n//       console.log(err);\n//     });\n// };\nvar onSuccessLogin=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(res){var _res$data;var token,_yield$getUserInfoByT,data,userType;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:token=res===null||res===void 0?void 0:(_res$data=res.data)===null||_res$data===void 0?void 0:_res$data.auth_token;setToken(token);_context.prev=2;_context.next=5;return getUserInfoByToken();case 5:_yield$getUserInfoByT=_context.sent;data=_yield$getUserInfoByT.data;userType=data.user_type;if(userType==='dispatcher')navigate(routes.dispatcher);if(userType==='bartender')navigate(routes.barmen);if(userType==='driver')navigate(routes.driver);_context.next=17;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](2);alert('Ошибка получения данных');console.log(_context.t0);case 17:case\"end\":return _context.stop();}},_callee,null,[[2,13]]);}));return function onSuccessLogin(_x){return _ref.apply(this,arguments);};}();var onSubmitLogin=function onSubmitLogin(e){e.preventDefault();loginQuery(inputPhone,inputPassword).then(function(res){res.request.status===200?onSuccessLogin(res):alert('неверные данные');}).catch(function(err){alert('Данные введены с ошибкой');console.log(err);});};return/*#__PURE__*/_jsxs(\"div\",{className:styles.container,children:[/*#__PURE__*/_jsx(Header,{isAuth:false}),/*#__PURE__*/_jsxs(\"section\",{className:styles.login_wrapper,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0412\\u0445\\u043E\\u0434 \\u0432 \\u043B\\u0438\\u0447\\u043D\\u044B\\u0439 \\u043A\\u0430\\u0431\\u0438\\u043D\\u0435\\u0442\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:onSubmitLogin,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",onChange:function onChange(e){return setInputPhone(e.target.value);},value:inputPhone,placeholder:\"\\u0422\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\",name:\"driver_phone_login\",id:\"driver_phone_login\",required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:inputPassword,onChange:function onChange(event){return setInputPassword(event.target.value);},placeholder:\"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\",name:\"driver_password_login\",id:\"driver_password_login\",required:true}),/*#__PURE__*/_jsx(\"button\",{type:'submit',children:\"\\u0412\\u043E\\u0439\\u0442\\u0438\"})]})]})]});}export default Login;","map":{"version":3,"names":["React","useState","styles","setToken","routes","useNavigate","Header","loginQuery","getUserInfoByToken","jsx","_jsx","jsxs","_jsxs","Login","_useState","_useState2","_slicedToArray","inputPhone","setInputPhone","_useState3","_useState4","inputPassword","setInputPassword","navigate","onSuccessLogin","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","res","_res$data","token","_yield$getUserInfoByT","data","userType","wrap","_callee$","_context","prev","next","auth_token","sent","user_type","dispatcher","barmen","driver","t0","alert","console","log","stop","_x","apply","arguments","onSubmitLogin","e","preventDefault","then","request","status","catch","err","className","container","children","isAuth","login_wrapper","onSubmit","type","onChange","target","value","placeholder","name","id","required","event"],"sources":["/Users/admin/Desktop/projects/wetop/taxi/frontend/src/pages/Login/Login.jsx"],"sourcesContent":["import React, { useState } from 'react';\nimport styles from './Login.module.scss';\nimport { setToken } from '../../services/localStorageService';\nimport { routes } from '../../helpers/routes';\nimport { useNavigate } from 'react-router-dom';\nimport Header from '../../components/Header/Header';\nimport { loginQuery } from '../../services/authService';\nimport { getUserInfoByToken } from '../../services/userService';\n\nfunction Login() {\n  const [inputPhone, setInputPhone] = useState('');\n  const [inputPassword, setInputPassword] = useState('');\n\n  const navigate = useNavigate();\n\n  // const onSuccessLogin = (res) => {\n  //   const token = res?.data?.auth_token;\n  //   setToken(token);\n  //   getUserInfoByToken()\n  //     .then(({ data }) => {\n  //       const userType = data.user_type;\n  //       if (userType === 'dispatcher') navigate(routes.dispatcher);\n  //       if (userType === 'bartender') navigate(routes.barmen);\n  //       if (userType === 'driver') navigate(routes.driver);\n  //     })\n  //     .catch((err) => {\n  //       alert('Ошибка получения данных');\n  //       console.log(err);\n  //     });\n  // };\n\n  const onSuccessLogin = async (res) => {\n    const token = res?.data?.auth_token;\n    setToken(token);\n    try {\n      const { data } = await getUserInfoByToken();\n      const userType = data.user_type;\n\n      if (userType === 'dispatcher') navigate(routes.dispatcher);\n      if (userType === 'bartender') navigate(routes.barmen);\n      if (userType === 'driver') navigate(routes.driver);\n    } catch (err) {\n      alert('Ошибка получения данных');\n      console.log(err);\n    }\n  };\n\n  const onSubmitLogin = (e) => {\n    e.preventDefault();\n    loginQuery(inputPhone, inputPassword)\n      .then((res) => {\n        res.request.status === 200\n          ? onSuccessLogin(res)\n          : alert('неверные данные');\n      })\n      .catch((err) => {\n        alert('Данные введены с ошибкой');\n        console.log(err);\n      });\n  };\n\n  return (\n    <div className={styles.container}>\n      <Header isAuth={false} />\n      <section className={styles.login_wrapper}>\n        <h2>Вход в личный кабинет</h2>\n        <form onSubmit={onSubmitLogin}>\n          <input\n            type=\"text\"\n            onChange={(e) => setInputPhone(e.target.value)}\n            value={inputPhone}\n            placeholder=\"Телефон\"\n            name=\"driver_phone_login\"\n            id=\"driver_phone_login\"\n            required={true}\n          />\n          <input\n            type=\"password\"\n            value={inputPassword}\n            onChange={(event) => setInputPassword(event.target.value)}\n            placeholder=\"Пароль\"\n            name=\"driver_password_login\"\n            id=\"driver_password_login\"\n            required={true}\n          />\n          <button type={'submit'}>Войти</button>\n        </form>\n      </section>\n    </div>\n  );\n}\n\nexport default Login;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}